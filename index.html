<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillShare+ | Learn, Earn, and Share Skills</title>
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            color: #333;
        }
        /* Common page container styling (active class is now less critical for display) */
        .page-container {
            /* Removed display: none; and display: block; from here.
               Visibility is now controlled directly by JavaScript's style.display */
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            font-size: 1.5rem;
            display: none; /* Hidden by default */
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="flex flex-col items-center">
            <svg class="animate-spin -ml-1 mr-3 h-10 w-10 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="mt-4">Loading...</p>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="bg-indigo-700 p-4 shadow-md rounded-b-lg">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#" id="nav-home" class="text-white text-3xl font-bold rounded-md p-2 hover:bg-indigo-600 transition-colors">SkillShare<span class="text-yellow-300">+</span></a>
            <div class="space-x-4">
                <a href="#how-it-works" class="text-white text-lg hover:text-yellow-300 transition-colors">How It Works</a>
                <a href="#features" class="text-white text-lg hover:text-yellow-300 transition-colors">Features</a>
                <a href="#team" class="text-white text-lg hover:text-yellow-300 transition-colors">Our Team</a>
                <!-- Link to show login/signup section or dashboard if logged in -->
                <button id="nav-auth-button" class="bg-yellow-400 text-indigo-900 px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-yellow-300 transition-all transform hover:scale-105">Join Now</button>
                <button id="nav-dashboard-button" class="hidden bg-green-500 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-green-600 transition-all transform hover:scale-105">Dashboard</button>
                <button id="nav-signout-button" class="hidden bg-red-500 text-white px-6 py-2 rounded-full font-semibold shadow-lg hover:bg-red-600 transition-all transform hover:scale-105">Sign Out</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area - This will hold all "pages" -->
    <div class="flex-grow container mx-auto p-8">

        <!-- ===== HOME PAGE / LANDING PAGE ===== -->
        <div id="home-page" class="page-container">
            <!-- Hero Section -->
            <header class="bg-gradient-to-r from-indigo-600 to-purple-700 text-white py-20 text-center rounded-b-lg shadow-inner mb-16">
                <div class="container mx-auto px-4">
                    <h1 class="text-5xl md:text-6xl font-extrabold mb-4 leading-tight">Learn, Earn, and Share Skills</h1>
                    <p class="text-xl md:text-2xl mb-8">All Within Your Campus ‚Äî SkillShare+ makes peer learning easy and rewarding.</p>
                    <!-- Link to show login/signup section or dashboard if logged in -->
                    <button id="hero-get-started" class="bg-yellow-400 text-indigo-900 px-10 py-4 rounded-full font-bold text-xl shadow-xl hover:bg-yellow-300 transition-all transform hover:scale-105">Get Started Today</button>
                </div>
            </header>

            <!-- Problem Section -->
            <section id="problem" class="mb-16 bg-white p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">The Problem We're Solving üßê</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm text-center">
                        <p class="text-lg font-semibold mb-2">Untapped Skills</p>
                        <p>Talented students often don't use their skills to help peers.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm text-center">
                        <p class="text-lg font-semibold mb-2">Finding Mentors</p>
                        <p>Juniors struggle to find trusted mentors for various skills.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm text-center">
                        <p class="text-lg font-semibold mb-2">Costly Tutors</p>
                        <p>No easy, affordable way to exchange skills within campus.</p>
                    </div>
                    <div class="p-6 bg-gray-50 rounded-lg shadow-sm text-center">
                        <p class="text-lg font-semibold mb-2">Lack of Exchange</p>
                        <p>Paid tutors are expensive and not campus-focused.</p>
                    </div>
                </div>
            </section>

            <!-- Solution Section -->
            <section id="solution" class="mb-16 bg-gradient-to-br from-blue-50 to-indigo-100 p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">Our Solution: SkillShare+ ‚ú®</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div>
                        <p class="text-lg mb-4 leading-relaxed">
                            SkillShare+ is a <strong class="text-indigo-700">campus-first, peer-to-peer teaching platform</strong> designed to empower students.
                            Seniors can teach juniors (and vice versa) in a wide array of skills, from coding and design to public speaking and academics.
                        </p>
                        <p class="text-lg leading-relaxed">
                            We introduce a unique <strong class="text-indigo-700">barter system</strong>: earn Skill Credits by teaching, and spend them to learn from others. For premium or urgent sessions, a <strong class="text-indigo-700">cash option</strong> is also available. Every session contributes to a <strong class="text-indigo-700">verified portfolio</strong>, a valuable record of skills taught and learned for resumes and recruiters.
                        </p>
                    </div>
                    <div class="flex justify-center">
                        <img src="https://placehold.co/400x250/d1e0fc/3a57e8?text=Campus+Learning" alt="Campus Learning Illustration" class="rounded-lg shadow-md">
                    </div>
                </div>
            </section>

            <!-- How It Works Section -->
            <section id="how-it-works" class="mb-16 bg-white p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">How It Works (Simple Steps) üöÄ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="flex flex-col items-center text-center p-6 bg-gray-50 rounded-lg shadow-sm">
                        <div class="text-indigo-600 text-5xl mb-4">1Ô∏è‚É£</div>
                        <h3 class="text-2xl font-semibold mb-2">Create Profile</h3>
                        <p>List skills you're eager to teach and what you want to learn.</p>
                    </div>
                    <div class="flex flex-col items-center text-center p-6 bg-gray-50 rounded-lg shadow-sm">
                        <div class="text-indigo-600 text-5xl mb-4">2Ô∏è‚É£</div>
                        <h3 class="text-2xl font-semibold mb-2">Book a Session</h3>
                        <p>Choose your payment method: Skill Credits or Cash.</p>
                    </div>
                    <div class="flex flex-col items-center text-center p-6 bg-gray-50 rounded-lg shadow-sm">
                        <div class="text-indigo-600 text-5xl mb-4">3Ô∏è‚É£</div>
                        <h3 class="text-2xl font-semibold mb-2">Teach & Learn</h3>
                        <p>Conduct sessions in-person on campus or online remotely.</p>
                    </div>
                    <div class="flex flex-col items-center text-center p-6 bg-gray-50 rounded-lg shadow-sm">
                        <div class="text-indigo-600 text-5xl mb-4">4Ô∏è‚É£</div>
                        <h3 class="text-2xl font-semibold mb-2">Earn & Grow</h3>
                        <p>Credits go to your wallet, portfolio updates automatically.</p>
                    </div>
                </div>
            </section>

            <!-- Unique Features Section -->
            <section id="features" class="mb-16 bg-gradient-to-br from-purple-50 to-red-50 p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">What Makes Us Unique? üåü</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-purple-600 text-3xl mr-4">ü§ù</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Barter Learning</h3>
                            <p>Learn new skills without spending a dime, just by sharing yours.</p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-purple-600 text-3xl mr-4">üè´</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Campus Trust</h3>
                            <p>Connect only with verified students from your own college community.</p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-purple-600 text-3xl mr-4">üí∞</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Dual Economy</h3>
                            <p>Use Skill Credits for bartering or cash for premium sessions.</p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-purple-600 text-3xl mr-4">üìÑ</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Verified Portfolio</h3>
                            <p>Build a strong, verifiable portfolio perfect for resumes and recruiters.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Revenue Model Section -->
            <section id="revenue" class="mb-16 bg-white p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">Our Revenue Model üìà</h2>
                <ul class="list-disc list-inside text-lg space-y-2 text-center max-w-2xl mx-auto">
                    <li>10-15% commission on <strong class="text-indigo-700">cash-based sessions</strong>.</li>
                    <li><strong class="text-indigo-700">Premium teacher profiles</strong> for higher visibility.</li>
                    <li>Paid <strong class="text-indigo-700">campus workshops & events</strong>.</li>
                    <li><strong class="text-indigo-700">Certification</strong> for completed learning paths.</li>
                </ul>
            </section>

            <!-- Market Opportunity Section -->
            <section id="market" class="mb-16 bg-gradient-to-br from-green-50 to-blue-50 p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">Market Opportunity üåç</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    <div>
                        <h3 class="text-2xl font-semibold text-green-700 mb-2">TAM (Total Addressable Market)</h3>
                        <p class="text-lg">Global e-learning & student tutoring market: <strong class="text-green-800">$20B+</strong></p>
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold text-blue-700 mb-2">SAM (Serviceable Available Market)</h3>
                        <p class="text-lg">Indian university network: <strong class="text-blue-800">$500M+</strong></p>
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold text-purple-700 mb-2">SOM (Serviceable Obtainable Market)</h3>
                        <p class="text-lg">Initial focus: 1,000‚Äì10,000 students in your campus + nearby colleges.</p>
                    </div>
                </div>
            </section>

            <!-- Growth Plan Section -->
            <section id="growth" class="mb-16 bg-white p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">Our Growth Plan üå±</h2>
                <ol class="list-decimal list-inside text-lg space-y-2 max-w-2xl mx-auto">
                    <li><strong class="text-indigo-700">Phase 1: Pilot</strong> in our college and collect valuable feedback.</li>
                    <li><strong class="text-indigo-700">Phase 2: Expand</strong> by adding local business-sponsored workshops.</li>
                    <li><strong class="text-indigo-700">Phase 3: Scale</strong> to multiple campuses with alumni involvement.</li>
                </ol>
            </section>

            <!-- Why This Will Succeed Section -->
            <section id="success" class="mb-16 bg-gradient-to-br from-yellow-50 to-orange-50 p-8 rounded-xl shadow-lg transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold text-center text-indigo-800 mb-8">Why SkillShare+ Will Succeed ‚úÖ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-orange-600 text-3xl mr-4">üéØ</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Real Problem, Immediate Impact</h3>
                            <p>Addresses a genuine student need with tangible benefits.</p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-orange-600 text-3xl mr-4">üåê</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Hybrid Model</h3>
                            <p>Works both offline (on-campus) and online (remote sessions).</p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-orange-600 text-3xl mr-4">üìö</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Learning Culture</h3>
                            <p>Actively encourages a collaborative learning environment in colleges.</p>
                        </div>
                    </div>
                    <div class="flex items-start p-6 bg-white rounded-lg shadow-md">
                        <span class="text-orange-600 text-3xl mr-4">üîÑ</span>
                        <div>
                            <h3 class="text-2xl font-semibold mb-2">Easy to Scale</h3>
                            <p>Every campus can become its own self-sustaining SkillShare+ hub.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Call to Action Section -->
            <section class="text-center py-16 bg-indigo-500 text-white rounded-xl shadow-xl transform transition-transform hover:scale-[1.01]">
                <h2 class="text-4xl font-bold mb-6">Let's Build a Campus Where Every Student Can Teach, Learn, and Grow ‚Äî Together.</h2>
                <p class="text-xl mb-8">Join the SkillShare+ community today and unlock a world of knowledge!</p>
                <!-- Button to show login/signup section -->
                <button id="cta-sign-up" class="bg-yellow-400 text-indigo-900 px-12 py-5 rounded-full font-bold text-2xl shadow-lg hover:bg-yellow-300 transition-all transform hover:scale-105">Sign Up Now!</button>
            </section>
        </div>

        <!-- ===== LOGIN / SIGNUP PAGE ===== -->
        <div id="auth-page" class="page-container flex justify-center items-center py-8 min-h-[calc(100vh-160px)]">
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md mx-4 sm:mx-auto">
                <h2 id="form-title" class="text-3xl font-bold text-center text-indigo-800 mb-8">Sign In to SkillShare+</h2>

                <!-- Login Form -->
                <form id="loginForm" class="space-y-6">
                    <div>
                        <label for="login-email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                        <input type="email" id="login-email" name="email" required
                               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300 hover:border-indigo-400">
                    </div>
                    <div>
                        <label for="login-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="login-password" name="password" required
                               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300 hover:border-indigo-400">
                    </div>
                    <button type="submit"
                            class="w-full bg-indigo-600 text-white py-3 px-4 rounded-md font-semibold text-lg shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-105">
                        Sign In
                    </button>
                    <p class="mt-4 text-center text-gray-600">
                        Don't have an account?
                        <a href="#" id="showSignup" class="font-medium text-indigo-600 hover:text-indigo-500 transition-colors">Sign Up</a>
                    </p>
                </form>

                <!-- Sign Up Form (hidden by default) -->
                <form id="signupForm" class="space-y-6 hidden">
                    <div>
                        <label for="signup-name" class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="signup-name" name="name" required
                               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300 hover:border-indigo-400">
                    </div>
                    <div>
                        <label for="signup-email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                        <input type="email" id="signup-email" name="email" required
                               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300 hover:border-indigo-400">
                    </div>
                    <div>
                        <label for="signup-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="signup-password" name="password" required
                               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300 hover:border-indigo-400">
                    </div>
                    <div>
                        <label for="signup-confirm-password" class="block text-sm font-medium text-gray-700 mb-2">Confirm Password</label>
                        <input type="password" id="signup-confirm-password" name="confirmPassword" required
                               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300 hover:border-indigo-400">
                    </div>
                    <button type="submit"
                            class="w-full bg-purple-600 text-white py-3 px-4 rounded-md font-semibold text-lg shadow-lg hover:bg-purple-700 transition-all transform hover:scale-105">
                        Create Account
                    </button>
                    <p class="mt-4 text-center text-gray-600">
                        Already have an account?
                        <a href="#" id="showLogin" class="font-medium text-purple-600 hover:text-purple-500 transition-colors">Sign In</a>
                    </p>
                </form>
            </div>
        </div>

        <!-- ===== USER DASHBOARD PAGE ===== -->
        <div id="dashboard-page" class="page-container text-center py-16 px-4">
            <h2 class="text-4xl font-bold text-indigo-800 mb-6">Welcome to Your SkillShare+ Dashboard! üéâ</h2>
            <p class="text-xl text-gray-700 mb-8">You are logged in as: <span id="current-user-email" class="font-semibold text-indigo-600"></span></p>
            <p id="current-user-id" class="text-sm text-gray-500 mb-4"></p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-4xl mx-auto">
                <!-- My Profile Card -->
                <div id="my-profile-card" class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-3">My Profile üë§</h3>
                    <p class="text-gray-600">Manage your bio and account details.</p>
                </div>
                <!-- Find a Session Card -->
                <div id="find-session-card" class="bg-gradient-to-br from-teal-500 to-green-600 text-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer transform hover:scale-105">
                    <h3 class="text-2xl font-semibold mb-3">Find a Session üîç</h3>
                    <p class="text-teal-100">Browse skills offered by other students.</p>
                </div>
                <!-- Teach a Skill Card -->
                <div id="teach-skill-card" class="bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer transform hover:scale-105">
                    <h3 class="text-2xl font-semibold mb-3">Teach a Skill ‚ú®</h3>
                    <p class="text-indigo-100">List a skill you can teach and get AI help with descriptions!</p>
                </div>
                <!-- My Skills Card -->
                <div id="my-skills-card" class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-3">My Skills üßë‚Äçüéì</h3>
                    <p class="text-gray-600">View and manage the skills you teach.</p>
                </div>
                <!-- My Wallet Card -->
                <div id="my-wallet-card" class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-3">My Wallet üí≥</h3>
                    <p class="text-gray-600">Check your Skill Credits and transaction history.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-3">My Sessions üóìÔ∏è</h3>
                    <p class="text-gray-600">View your upcoming and past learning/teaching sessions.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-3">Events & Workshops üè´</h3>
                    <p class="text-gray-600">Discover campus events and paid workshops.</p>
                </div>
            </div>

            <!-- Available Skills Section -->
            <section id="available-skills-section" class="mt-16 bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-4xl font-bold text-indigo-800 mb-8">Available Skills on Campus üìö</h2>
                <div id="skills-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Skills will be loaded here by JavaScript -->
                    <p class="text-gray-600 text-lg" id="no-skills-message">No skills listed yet. Be the first to teach!</p>
                </div>
            </section>

        </div>

        <!-- ===== TEACH A SKILL PAGE ===== -->
        <div id="teach-skill-page" class="page-container py-8 px-4">
            <h2 class="text-4xl font-bold text-indigo-800 mb-8 text-center">Teach a New Skill üßë‚Äçüè´</h2>
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-2xl mx-auto">
                <p class="text-lg text-gray-700 mb-6 text-center">Enter your skill, and let our AI help you craft a perfect description!</p>

                <div class="space-y-6">
                    <div>
                        <label for="skill-name-input" class="block text-sm font-medium text-gray-700 mb-2">Skill Name</label>
                        <input type="text" id="skill-name-input" placeholder="e.g., Python Programming, Public Speaking, Guitar Basics"
                               class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <button id="generate-description-btn"
                            class="w-full bg-purple-600 text-white py-3 px-4 rounded-md font-semibold text-lg shadow-lg hover:bg-purple-700 transition-all transform hover:scale-105">
                        Generate Description ‚ú®
                    </button>
                    <div>
                        <label for="skill-description-textarea" class="block text-sm font-medium text-gray-700 mb-2">Skill Description</label>
                        <textarea id="skill-description-textarea" rows="8"
                                  class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                                  placeholder="Generated description will appear here..."></textarea>
                    </div>
                    <button id="save-skill-btn"
                            class="w-full bg-indigo-600 text-white py-3 px-4 rounded-md font-semibold text-lg shadow-lg hover:bg-indigo-700 transition-all transform hover:scale-105">
                        Save Skill
                    </button>
                </div>
            </div>
        </div>

        <!-- ===== MY PROFILE PAGE ===== -->
        <div id="my-profile-page" class="page-container py-8 px-4">
            <h2 class="text-4xl font-bold text-indigo-800 mb-8 text-center">My Profile üë§</h2>
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-2xl mx-auto">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Name:</label>
                        <p id="profile-name" class="text-lg font-semibold text-gray-800"></p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email:</label>
                        <p id="profile-email" class="text-lg font-semibold text-gray-800"></p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Member Since:</label>
                        <p id="profile-member-since" class="text-lg font-semibold text-gray-800"></p>
                    </div>
                    <button id="edit-profile-btn" class="mt-6 w-full bg-blue-600 text-white py-3 px-4 rounded-md font-semibold text-lg shadow-lg hover:bg-blue-700 transition-all transform hover:scale-105">Edit Profile</button>
                </div>
            </div>
        </div>

        <!-- ===== MY SKILLS PAGE ===== -->
        <div id="my-skills-page" class="page-container py-8 px-4">
            <h2 class="text-4xl font-bold text-indigo-800 mb-8 text-center">My Skills üßë‚Äçüéì</h2>
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-4xl mx-auto">
                <div id="my-skills-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <p class="text-gray-600 text-lg" id="no-my-skills-message">You haven't listed any skills yet. Go to "Teach a Skill" to add one!</p>
                </div>
            </div>
        </div>

        <!-- ===== MY WALLET PAGE ===== -->
        <div id="my-wallet-page" class="page-container py-8 px-4">
            <h2 class="text-4xl font-bold text-indigo-800 mb-8 text-center">My Wallet üí≥</h2>
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-2xl mx-auto text-center">
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Current Skill Credits:</label>
                    <p id="wallet-credits" class="text-5xl font-bold text-green-600">0</p>
                </div>
                <h3 class="text-2xl font-bold text-indigo-700 mb-4">Transaction History</h3>
                <div id="transaction-history" class="space-y-3 text-left">
                    <p class="text-gray-600 italic">No transactions yet.</p>
                    <!-- Transactions will be loaded here -->
                </div>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="bg-indigo-900 text-white p-8 mt-16 rounded-t-lg">
        <div class="container mx-auto text-center">
            <p>&copy; 2025 SkillShare+. All rights reserved.</p>
            <p class="mt-2 text-sm">Made with ‚ù§Ô∏è for the Hackathon</p>
        </div>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, collection, addDoc, onSnapshot, query, getDoc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Hardcoded Firebase Config (as provided by the user)
        const firebaseConfig = {
            apiKey: "AIzaSyBqyyOV7fXnfEZBNRChGWlU8XVCBn7Zy40",
            authDomain: "skillshare-746fb.firebaseapp.com",
            projectId: "skillshare-746fb",
            storageBucket: "skillshare-746fb.firebasestorage.app",
            messagingSenderId: "571656018320",
            appId: "1:571656018320:web:8f6bdb99bf4f10e11e7b15",
            measurementId: "G-NJRSQ0FCM1"
        };

        // App ID for Firestore paths (derived from firebaseConfig.projectId if __app_id is not present)
        const appId = typeof __app_id !== 'undefined' ? __app_id : firebaseConfig.projectId;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;


        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUserId = null;
        let currentUserEmail = null;
        let currentUserName = null;
        let currentUserCredits = 0; // To store user's credits

        // Gemini API Configuration
        const GEMINI_API_KEY = ""; // Canvas will automatically provide this at runtime
        const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${GEMINI_API_KEY}`;

        // --- Helper Function for Exponential Backoff (for API calls) ---
        async function retryOperation(operation, maxRetries = 5, delay = 1000) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    return await operation();
                } catch (error) {
                    // Only retry on specific errors (e.g., rate limit, network issues)
                    if (error.code === 'resource-exhausted' || error.code === 'unavailable' || error.code === 'internal' || (error.message && error.message.includes('500') || error.message.includes('503'))) {
                        await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                    } else {
                        throw error; // Re-throw if not a retryable error
                    }
                }
            }
            throw new Error('Operation failed after multiple retries.');
        }

        // --- UI Element References ---
        const homePage = document.getElementById('home-page');
        const authPage = document.getElementById('auth-page');
        const dashboardPage = document.getElementById('dashboard-page');
        const teachSkillPage = document.getElementById('teach-skill-page');
        const myProfilePage = document.getElementById('my-profile-page'); // New page
        const mySkillsPage = document.getElementById('my-skills-page');   // New page
        const myWalletPage = document.getElementById('my-wallet-page');   // New page

        const navHomeButton = document.getElementById('nav-home');
        const navAuthButton = document.getElementById('nav-auth-button');
        const navDashboardButton = document.getElementById('nav-dashboard-button');
        const navSignoutButton = document.getElementById('nav-signout-button');
        const heroGetStartedButton = document.getElementById('hero-get-started');
        const ctaSignUpButton = document.getElementById('cta-sign-up');

        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const showSignupLink = document.getElementById('showSignup');
        const showLoginLink = document.getElementById('showLogin');
        const formTitle = document.getElementById('form-title');

        const currentUserEmailSpan = document.getElementById('current-user-email');
        const currentUserIdSpan = document.getElementById('current-user-id');
        const loadingOverlay = document.getElementById('loading-overlay');

        const myProfileCard = document.getElementById('my-profile-card'); // Dashboard card
        const findSessionCard = document.getElementById('find-session-card');
        const teachSkillCard = document.getElementById('teach-skill-card');
        const mySkillsCard = document.getElementById('my-skills-card');     // Dashboard card
        const myWalletCard = document.getElementById('my-wallet-card');     // Dashboard card

        const skillNameInput = document.getElementById('skill-name-input');
        const generateDescriptionBtn = document.getElementById('generate-description-btn');
        const skillDescriptionTextarea = document.getElementById('skill-description-textarea');
        const saveSkillBtn = document.getElementById('save-skill-btn');
        const skillsListContainer = document.getElementById('skills-list');
        const noSkillsMessage = document.getElementById('no-skills-message');

        const profileNameEl = document.getElementById('profile-name');
        const profileEmailEl = document.getElementById('profile-email');
        const profileMemberSinceEl = document.getElementById('profile-member-since');
        const editProfileBtn = document.getElementById('edit-profile-btn');

        const mySkillsListContainer = document.getElementById('my-skills-list');
        const noMySkillsMessage = document.getElementById('no-my-skills-message');

        const walletCreditsEl = document.getElementById('wallet-credits');
        const transactionHistoryEl = document.getElementById('transaction-history');


        // --- Custom Message Box Functionality (replaces alert()) ---
        function displayMessage(messageText) {
            let messageBox = document.getElementById('custom-message-box');
            if (!messageBox) {
                messageBox = document.createElement('div');
                messageBox.id = 'custom-message-box';
                messageBox.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
                messageBox.innerHTML = `
                    <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full text-center">
                        <p class="text-lg font-semibold mb-4 text-gray-800">${messageText}</p>
                        <button class="bg-indigo-600 text-white px-5 py-2 rounded-md hover:bg-indigo-700 transition-colors">OK</button>
                    </div>
                `;
                document.body.appendChild(messageBox);

                // Add event listener to close the message box
                messageBox.querySelector('button').addEventListener('click', () => {
                    messageBox.remove();
                });
            } else {
                // If message box already exists, just update its text and show it
                messageBox.querySelector('p').textContent = messageText;
                messageBox.style.display = 'flex';
            }
        }

        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }

        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }

        // --- Page Navigation Logic ---
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page-container');
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.style.display = 'block'; // Directly set to block
                } else {
                    page.style.display = 'none'; // Directly set to none
                }
            });
            // Scroll to top of the page when navigating
            window.scrollTo(0, 0);
        }

        // --- Firebase Authentication State Listener ---
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // User is signed in.
                currentUserId = user.uid;
                currentUserEmail = user.email;
                console.log("User logged in:", currentUserEmail, currentUserId);
                navAuthButton.classList.add('hidden'); // Hide Join Now/Auth button
                navDashboardButton.classList.remove('hidden'); // Show Dashboard button
                navSignoutButton.classList.remove('hidden'); // Show Sign Out button
                currentUserEmailSpan.textContent = currentUserEmail || 'Guest User';
                currentUserIdSpan.textContent = `User ID: ${currentUserId}`;

                // Fetch user profile data
                await fetchUserProfile(currentUserId);

                showPage('dashboard-page'); // Redirect to dashboard
                loadAndDisplaySkills(); // Load all public skills
            } else {
                // User is signed out.
                currentUserId = null;
                currentUserEmail = null;
                currentUserName = null;
                currentUserCredits = 0;
                console.log("User logged out or not authenticated.");
                navAuthButton.classList.remove('hidden'); // Show Join Now/Auth button
                navDashboardButton.classList.add('hidden'); // Hide Dashboard button
                navSignoutButton.classList.add('hidden'); // Hide Sign Out button
                showPage('home-page'); // Redirect to home page
            }
            hideLoading(); // Hide loading overlay once auth state is determined
        });

        // --- Initial Authentication Attempt (Custom Token or Anonymous) ---
        async function initializeAuth() {
            showLoading();
            try {
                if (initialAuthToken) {
                    try {
                        await retryOperation(() => signInWithCustomToken(auth, initialAuthToken));
                        console.log("Signed in with custom token.");
                    } catch (customTokenError) {
                        console.warn("Custom token sign-in failed, falling back to anonymous:", customTokenError);
                        // If custom token fails (e.g., mismatch, expiry), try anonymous sign-in
                        await retryOperation(() => signInAnonymously(auth));
                        console.log("Signed in anonymously after custom token fallback.");
                    }
                } else {
                    await retryOperation(() => signInAnonymously(auth));
                    console.log("Signed in anonymously.");
                }
            } catch (error) {
                console.error("Firebase Auth initialization error:", error);
                displayMessage(`Authentication error: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        // Call the initial auth function on load
        initializeAuth();


        // --- Event Listeners for Page Navigation ---
        navHomeButton.addEventListener('click', (e) => {
            e.preventDefault();
            showPage('home-page');
        });

        navAuthButton.addEventListener('click', () => {
            showPage('auth-page');
            // Ensure login form is shown by default when navigating to auth page
            loginForm.classList.remove('hidden'); // Ensure login form is visible
            signupForm.classList.add('hidden');    // Ensure signup form is hidden
            formTitle.textContent = 'Sign In to SkillShare+';
        });

        navDashboardButton.addEventListener('click', () => {
            showPage('dashboard-page');
            loadAndDisplaySkills(); // Reload skills when returning to dashboard
        });

        heroGetStartedButton.addEventListener('click', () => {
            showPage('auth-page');
            loginForm.classList.remove('hidden');
            signupForm.classList.add('hidden');
            formTitle.textContent = 'Sign In to SkillShare+';
        });

        ctaSignUpButton.addEventListener('click', () => {
            showPage('auth-page');
            signupForm.classList.remove('hidden');
            loginForm.classList.add('hidden');
            formTitle.textContent = 'Create Your SkillShare+ Account';
        });

        navSignoutButton.addEventListener('click', async () => {
            showLoading();
            try {
                await retryOperation(() => signOut(auth));
                displayMessage('You have been signed out successfully!');
            } catch (error) {
                console.error("Error signing out:", error);
                displayMessage(`Error signing out: ${error.message}`);
            } finally {
                hideLoading();
            }
        });

        // --- Event Listeners for Auth Form Toggling ---
        showSignupLink.addEventListener('click', (e) => {
            e.preventDefault();
            loginForm.classList.add('hidden');
            signupForm.classList.remove('hidden');
            formTitle.textContent = 'Create Your SkillShare+ Account';
        });

        showLoginLink.addEventListener('click', (e) => {
            e.preventDefault();
            signupForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
            formTitle.textContent = 'Sign In to SkillShare+';
        });

        // --- Handle Login Form Submission ---
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            showLoading();
            const email = loginForm.elements['login-email'].value;
            const password = loginForm.elements['login-password'].value;

            try {
                await retryOperation(() => signInWithEmailAndPassword(auth, email, password));
                // onAuthStateChanged will handle page redirection upon successful login
                loginForm.reset(); // Clear form
            } catch (error) {
                let errorMessage = "An unknown error occurred during login.";
                switch (error.code) {
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address format.';
                        break;
                    case 'auth/user-disabled':
                        errorMessage = 'This account has been disabled.';
                        break;
                    case 'auth/user-not-found':
                        errorMessage = 'No user found with this email.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Incorrect password.';
                        break;
                    default:
                        errorMessage = `Login failed: ${error.message}`;
                }
                displayMessage(errorMessage);
                console.error("Login Error:", error);
            } finally {
                hideLoading();
            }
        });

        // --- Handle Sign Up Form Submission ---
        signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            showLoading();
            const name = signupForm.elements['signup-name'].value;
            const email = signupForm.elements['signup-email'].value;
            const password = signupForm.elements['signup-password'].value;
            const confirmPassword = signupForm.elements['signup-confirm-password'].value;

            if (password !== confirmPassword) {
                displayMessage('Passwords do not match!');
                hideLoading();
                return;
            }

            try {
                const userCredential = await retryOperation(() => createUserWithEmailAndPassword(auth, email, password));
                const user = userCredential.user;

                // Store user profile data in Firestore (private)
                const userProfileRef = doc(db, `artifacts/${appId}/users/${user.uid}/profiles`, user.uid);
                await retryOperation(() => setDoc(userProfileRef, {
                    name: name,
                    email: email,
                    createdAt: new Date(),
                    credits: 0 // Initialize credits for new users
                }));

                // onAuthStateChanged will handle page redirection upon successful signup
                signupForm.reset(); // Clear form
            } catch (error) {
                let errorMessage = "An unknown error occurred during signup.";
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'The email address is already in use by another account.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address format.';
                        break;
                    case 'auth/operation-not-allowed':
                        errorMessage = 'Email/password accounts are not enabled. Please contact support.';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'Password is too weak. Please choose a stronger password.';
                        break;
                    default:
                        errorMessage = `Sign up failed: ${error.message}`;
                }
                displayMessage(errorMessage);
                console.error("Sign Up Error:", error);
            } finally {
                hideLoading();
            }
        });

        // --- Dashboard Card Navigation ---
        myProfileCard.addEventListener('click', () => {
            showPage('my-profile-page');
            populateProfilePage(); // Populate profile data when navigating
        });

        findSessionCard.addEventListener('click', () => {
            showPage('dashboard-page'); // Stay on dashboard
            document.getElementById('available-skills-section').scrollIntoView({ behavior: 'smooth' });
        });

        teachSkillCard.addEventListener('click', () => {
            showPage('teach-skill-page');
            skillNameInput.value = '';
            skillDescriptionTextarea.value = '';
        });

        mySkillsCard.addEventListener('click', () => {
            showPage('my-skills-page');
            loadAndDisplayMySkills(); // Load skills taught by current user
        });

        myWalletCard.addEventListener('click', () => {
            showPage('my-wallet-page');
            populateWalletPage(); // Populate wallet data
        });

        // --- My Profile Page Functions ---
        async function fetchUserProfile(userId) {
            if (!userId) return;
            const userProfileRef = doc(db, `artifacts/${appId}/users/${userId}/profiles`, userId);
            try {
                const docSnap = await retryOperation(() => getDoc(userProfileRef));
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    currentUserName = data.name;
                    currentUserEmail = data.email; // Ensure email is updated from profile
                    currentUserCredits = data.credits;
                    profileNameEl.textContent = data.name;
                    profileEmailEl.textContent = data.email;
                    if (data.createdAt && data.createdAt.toDate) {
                        profileMemberSinceEl.textContent = data.createdAt.toDate().toLocaleDateString();
                    } else {
                        profileMemberSinceEl.textContent = 'N/A';
                    }
                } else {
                    console.warn("User profile not found in Firestore. Creating a default one.");
                    // Create a basic profile if it doesn't exist for some reason
                    // This might happen if user signs in anonymously first, then with email/password
                    await retryOperation(() => setDoc(userProfileRef, {
                        name: currentUserEmail ? currentUserEmail.split('@')[0] : 'New User', // Default name from email or generic
                        email: currentUserEmail,
                        createdAt: new Date(),
                        credits: 0
                    }));
                    currentUserName = currentUserEmail ? currentUserEmail.split('@')[0] : 'New User';
                    currentUserCredits = 0;
                    populateProfilePage(); // Re-populate after creating
                }
            } catch (error) {
                console.error("Error fetching user profile:", error);
                displayMessage(`Error loading profile: ${error.message}`);
            }
        }

        function populateProfilePage() {
            profileNameEl.textContent = currentUserName || 'Not set';
            profileEmailEl.textContent = currentUserEmail || 'N/A';
            // Member since is populated by fetchUserProfile based on stored data
        }

        editProfileBtn.addEventListener('click', () => {
            displayMessage('Edit Profile functionality coming soon! For now, you can only update your name.');
            // In a real app, this would open a modal or navigate to an edit form.
            // For simplicity, we'll just show a message.
            // You could add an input field here to allow editing of the name.
        });

        // --- My Wallet Page Functions ---
        function populateWalletPage() {
            walletCreditsEl.textContent = currentUserCredits;
            // For transaction history, you'd typically fetch from a 'transactions' subcollection
            // For now, it's a placeholder.
            transactionHistoryEl.innerHTML = '<p class="text-gray-600 italic">Transaction history coming soon!</p>';
        }


        // --- Generate Skill Description with Gemini API ---
        generateDescriptionBtn.addEventListener('click', async () => {
            const skillName = skillNameInput.value.trim();
            if (!skillName) {
                displayMessage('Please enter a skill name to generate a description.');
                return;
            }

            showLoading();
            try {
                const prompt = `Generate a concise, engaging, and detailed description for a peer-to-peer learning platform session about the skill "${skillName}". Focus on what a student would learn, the benefits, and what makes it interesting. Make it suitable for a college student audience. Limit to approximately 100-150 words.`;
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = GEMINI_API_KEY; // This will be automatically populated by Canvas
                const apiUrl = GEMINI_API_URL;

                const response = await retryOperation(() => fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                }));

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    skillDescriptionTextarea.value = text;
                } else {
                    displayMessage('Failed to generate description. Please try again.');
                    console.error('Gemini API response structure unexpected:', result);
                }
            } catch (error) {
                displayMessage(`Error generating description: ${error.message}`);
                console.error('Gemini API call error:', error);
            } finally {
                hideLoading();
            }
        });

        // --- Save Skill to Firestore (Public Collection) ---
        saveSkillBtn.addEventListener('click', async () => {
            const skillName = skillNameInput.value.trim();
            const skillDescription = skillDescriptionTextarea.value.trim();

            if (!skillName || !skillDescription) {
                displayMessage('Please provide both a skill name and description to save.');
                return;
            }
            if (!currentUserId) {
                displayMessage('You must be logged in to save a skill.');
                showPage('auth-page'); // Redirect to login if not logged in
                return;
            }

            showLoading();
            try {
                // Path: artifacts/{appId}/public/data/skills
                const publicSkillsCollectionRef = collection(db, `artifacts/${appId}/public/data/skills`);
                await retryOperation(() => addDoc(publicSkillsCollectionRef, {
                    name: skillName,
                    description: skillDescription,
                    teacherId: currentUserId,
                    teacherEmail: currentUserEmail,
                    createdAt: new Date()
                }));
                displayMessage('Skill saved successfully! Your skill is now listed for others to find.');
                skillNameInput.value = ''; // Clear form
                skillDescriptionTextarea.value = ''; // Clear form
                showPage('dashboard-page'); // Go back to dashboard and refresh skills
            } catch (error) {
                displayMessage(`Error saving skill: ${error.message}`);
                console.error('Firestore save skill error:', error);
            } finally {
                hideLoading();
            }
        });

        // --- Load and Display ALL Public Skills (Real-time with onSnapshot) ---
        function loadAndDisplaySkills() {
            if (!currentUserId) {
                console.log("User not logged in, cannot load skills.");
                return;
            }

            showLoading();
            const skillsRef = collection(db, `artifacts/${appId}/public/data/skills`);
            const q = query(skillsRef);

            onSnapshot(q, (snapshot) => {
                skillsListContainer.innerHTML = '';
                if (snapshot.empty) {
                    noSkillsMessage.style.display = 'block';
                } else {
                    noSkillsMessage.style.display = 'none';
                    snapshot.forEach((doc) => {
                        const skill = doc.data();
                        const skillId = doc.id; // Get the document ID

                        const skillCard = document.createElement('div');
                        skillCard.className = 'bg-gray-50 p-6 rounded-lg shadow-md flex flex-col items-start text-left space-y-2';
                        skillCard.innerHTML = `
                            <h3 class="text-xl font-semibold text-indigo-700">${skill.name}</h3>
                            <p class="text-gray-600 text-sm flex-grow">${skill.description}</p>
                            <p class="text-sm text-gray-500 mt-2">Taught by: <span class="font-medium">${skill.teacherEmail}</span></p>
                            <button class="mt-3 w-full bg-teal-500 text-white px-4 py-2 rounded-md hover:bg-teal-600 transition-colors" data-skill-id="${skillId}" data-skill-name="${skill.name}" data-teacher-email="${skill.teacherEmail}">Book Session</button>
                        `;
                        skillsListContainer.appendChild(skillCard);
                    });
                    // Add event listeners for "Book Session" buttons
                    document.querySelectorAll('#skills-list button').forEach(button => {
                        button.addEventListener('click', (event) => {
                            const skillId = event.target.dataset.skillId;
                            const skillName = event.target.dataset.skillName;
                            const teacherEmail = event.target.dataset.teacherEmail;
                            displayMessage(`You are interested in booking "${skillName}" from ${teacherEmail}. A notification has been sent to the teacher.`);
                            // In a real app, this would trigger a more complex booking flow,
                            // like sending an email, creating a chat, or a session request in Firestore.
                        });
                    });
                }
                hideLoading();
            }, (error) => {
                console.error("Error fetching skills:", error);
                displayMessage(`Failed to load skills: ${error.message}`);
                hideLoading();
            });
        }

        // --- Load and Display MY Skills (Real-time with onSnapshot) ---
        function loadAndDisplayMySkills() {
            if (!currentUserId) {
                console.log("User not logged in, cannot load my skills.");
                mySkillsListContainer.innerHTML = '';
                noMySkillsMessage.style.display = 'block';
                return;
            }

            showLoading();
            const mySkillsRef = collection(db, `artifacts/${appId}/public/data/skills`);
            const q = query(mySkillsRef);

            onSnapshot(q, (snapshot) => {
                mySkillsListContainer.innerHTML = '';
                let hasMySkills = false;
                snapshot.forEach((doc) => {
                    const skill = doc.data();
                    const skillId = doc.id;
                    if (skill.teacherId === currentUserId) {
                        hasMySkills = true;
                        const mySkillCard = document.createElement('div');
                        mySkillCard.className = 'bg-white p-6 rounded-lg shadow-md flex flex-col items-start text-left space-y-2 border border-indigo-200';
                        mySkillCard.innerHTML = `
                            <h3 class="text-xl font-semibold text-indigo-700">${skill.name}</h3>
                            <p class="text-gray-600 text-sm flex-grow">${skill.description}</p>
                            <p class="text-sm text-gray-500 mt-2">Listed on: ${skill.createdAt.toDate().toLocaleDateString()}</p>
                            <div class="flex space-x-2 mt-3 w-full">
                                <button class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors" data-skill-id="${skillId}" data-skill-name="${skill.name}" data-skill-description="${skill.description}">Edit</button>
                                <button class="flex-1 bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors" data-skill-id="${skillId}">Delete</button>
                            </div>
                        `;
                        mySkillsListContainer.appendChild(mySkillCard);
                    }
                });

                if (!hasMySkills) {
                    noMySkillsMessage.style.display = 'block';
                } else {
                    noMySkillsMessage.style.display = 'none';
                }

                mySkillsListContainer.querySelectorAll('button[data-skill-id]').forEach(button => {
                    if (button.textContent === 'Edit') {
                        button.addEventListener('click', (event) => {
                            const skillId = event.target.dataset.skillId;
                            const skillName = event.target.dataset.skillName;
                            const skillDescription = event.target.dataset.skillDescription;
                            showPage('teach-skill-page');
                            skillNameInput.value = skillName;
                            skillDescriptionTextarea.value = skillDescription;
                            displayMessage(`Editing skill: "${skillName}". Make changes and re-save.`);
                        });
                    } else if (button.textContent === 'Delete') {
                        button.addEventListener('click', async (event) => {
                            const skillId = event.target.dataset.skillId;
                            // Using a custom message box for confirmation instead of window.confirm
                            const confirmDelete = await new Promise(resolve => {
                                let confirmBox = document.createElement('div');
                                confirmBox.id = 'custom-confirm-box';
                                confirmBox.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
                                confirmBox.innerHTML = `
                                    <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full text-center">
                                        <p class="text-lg font-semibold mb-4 text-gray-800">Are you sure you want to delete this skill?</p>
                                        <div class="flex justify-center space-x-4">
                                            <button id="confirm-yes" class="bg-red-600 text-white px-5 py-2 rounded-md hover:bg-red-700 transition-colors">Yes</button>
                                            <button id="confirm-no" class="bg-gray-300 text-gray-800 px-5 py-2 rounded-md hover:bg-gray-400 transition-colors">No</button>
                                        </div>
                                    </div>
                                `;
                                document.body.appendChild(confirmBox);

                                document.getElementById('confirm-yes').addEventListener('click', () => {
                                    confirmBox.remove();
                                    resolve(true);
                                });
                                document.getElementById('confirm-no').addEventListener('click', () => {
                                    confirmBox.remove();
                                    resolve(false);
                                });
                            });

                            if (confirmDelete) {
                                showLoading();
                                try {
                                    const skillDocRef = doc(db, `artifacts/${appId}/public/data/skills`, skillId);
                                    await retryOperation(() => deleteDoc(skillDocRef));
                                    displayMessage('Skill deleted successfully!');
                                } catch (error) {
                                    displayMessage(`Error deleting skill: ${error.message}`);
                                    console.error('Firestore delete skill error:', error);
                                } finally {
                                    hideLoading();
                                }
                            }
                        });
                    }
                });

                hideLoading();
            }, (error) => {
                console.error("Error fetching my skills:", error);
                displayMessage(`Failed to load your skills: ${error.message}`);
                hideLoading();
            });
        }
    </script>
</body>
</html>
```
---

### The Fix Explained:

1.  **Direct `style.display` Manipulation:**
    * In the `<style>` block, I've removed the `display: none;` and `display: block;` rules from the `.page-container` and `.page-container.active` classes.
    * Instead, the `showPage(pageId)` JavaScript function now directly sets `page.style.display = 'block';` for the active page and `page.style.display = 'none';` for all other pages. This is a more forceful way to control visibility and bypasses potential CSS specificity issues.
2.  **Initial Page State:**
    * The `active` class has been removed from the `home-page` div in the HTML. The initial display of the correct page (home or dashboard) is now entirely handled by the `initializeAuth()` and `onAuthStateChanged()` functions calling `showPage()`.
3.  **Custom Confirmation for Delete:**
    * I've also updated the "Delete" button logic on the "My Skills" page to use a **custom confirmation message box** instead of the browser's native `confirm()` alert. This provides a more consistent UI experience, as `window.confirm()` can be blocked or behave unexpectedly in certain environments.

With these changes, when you successfully sign in, the `onAuthStateChanged` listener will call `showPage('dashboard-page')`, which will explicitly set the `auth-page` to `display: none;`, ensuring it vanishes as expect
